import React, { useState, useEffect } from 'react';\nimport {\n  CheckCircleIcon,\n  XCircleIcon,\n  ExclamationTriangleIcon,\n  WrenchScrewdriverIcon,\n  CommandLineIcon,\n  DocumentTextIcon,\n  ArrowPathIcon\n} from '@heroicons/react/24/outline';\nimport apiService from '../services/api';\n\nfunction SecurityToolsStatus({ onClose }) {\n  const [toolsStatus, setToolsStatus] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [activeTab, setActiveTab] = useState('status');\n  const [testingTool, setTestingTool] = useState(null);\n\n  useEffect(() => {\n    checkToolsStatus();\n  }, []);\n\n  const checkToolsStatus = async () => {\n    try {\n      setLoading(true);\n      const response = await apiService.request('/tools/status');\n      setToolsStatus(response);\n    } catch (error) {\n      console.error('Failed to check tools status:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const testTool = async (toolName) => {\n    try {\n      setTestingTool(toolName);\n      const response = await apiService.request(`/tools/test/${toolName}`, {\n        method: 'POST'\n      });\n      \n      // Update tool status\n      setToolsStatus(prev => ({\n        ...prev,\n        tools: {\n          ...prev.tools,\n          [toolName]: {\n            ...prev.tools[toolName],\n            available: response.available,\n            version: response.version\n          }\n        }\n      }));\n    } catch (error) {\n      console.error('Tool test failed:', error);\n    } finally {\n      setTestingTool(null);\n    }\n  };\n\n  const getStatusColor = (available) => {\n    return available ? 'text-green-400' : 'text-red-400';\n  };\n\n  const getStatusIcon = (available) => {\n    return available ? CheckCircleIcon : XCircleIcon;\n  };\n\n  const getReadinessColor = (percentage) => {\n    if (percentage >= 80) return 'text-green-400';\n    if (percentage >= 50) return 'text-yellow-400';\n    return 'text-red-400';\n  };\n\n  if (loading) {\n    return (\n      <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n        <div className=\"bg-slate-800 rounded-lg p-8 border border-slate-600\">\n          <div className=\"flex items-center space-x-3\">\n            <ArrowPathIcon className=\"w-6 h-6 text-blue-400 animate-spin\" />\n            <span className=\"text-white\">Checking security tools...</span>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-slate-800 rounded-lg border border-slate-600 w-full max-w-4xl max-h-[90vh] overflow-hidden\">\n        {/* Header */}\n        <div className=\"bg-gradient-to-r from-blue-600 to-cyan-600 p-6 flex items-center justify-between\">\n          <div className=\"flex items-center space-x-3\">\n            <WrenchScrewdriverIcon className=\"w-8 h-8 text-white\" />\n            <div>\n              <h2 className=\"text-2xl font-bold text-white\">Security Tools Status</h2>\n              <p className=\"text-blue-100\">Professional cybersecurity tools integration</p>\n            </div>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"text-white hover:text-slate-200 transition\"\n          >\n            <XCircleIcon className=\"w-6 h-6\" />\n          </button>\n        </div>\n\n        {/* Summary */}\n        {toolsStatus && (\n          <div className=\"bg-slate-700 p-4 border-b border-slate-600\">\n            <div className=\"grid grid-cols-4 gap-4 text-center\">\n              <div>\n                <div className=\"text-2xl font-bold text-white\">{toolsStatus.summary.total}</div>\n                <div className=\"text-sm text-slate-400\">Total Tools</div>\n              </div>\n              <div>\n                <div className=\"text-2xl font-bold text-green-400\">{toolsStatus.summary.available}</div>\n                <div className=\"text-sm text-slate-400\">Available</div>\n              </div>\n              <div>\n                <div className=\"text-2xl font-bold text-red-400\">{toolsStatus.summary.missing}</div>\n                <div className=\"text-sm text-slate-400\">Missing</div>\n              </div>\n              <div>\n                <div className={`text-2xl font-bold ${getReadinessColor(toolsStatus.summary.readiness)}`}>\n                  {toolsStatus.summary.readiness}%\n                </div>\n                <div className=\"text-sm text-slate-400\">Readiness</div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Tabs */}\n        <div className=\"flex border-b border-slate-600\">\n          <button\n            onClick={() => setActiveTab('status')}\n            className={`px-6 py-3 font-medium transition ${\n              activeTab === 'status'\n                ? 'text-blue-400 border-b-2 border-blue-400'\n                : 'text-slate-400 hover:text-white'\n            }`}\n          >\n            Tool Status\n          </button>\n          <button\n            onClick={() => setActiveTab('install')}\n            className={`px-6 py-3 font-medium transition ${\n              activeTab === 'install'\n                ? 'text-blue-400 border-b-2 border-blue-400'\n                : 'text-slate-400 hover:text-white'\n            }`}\n          >\n            Installation Guide\n          </button>\n          <button\n            onClick={() => setActiveTab('recommendations')}\n            className={`px-6 py-3 font-medium transition ${\n              activeTab === 'recommendations'\n                ? 'text-blue-400 border-b-2 border-blue-400'\n                : 'text-slate-400 hover:text-white'\n            }`}\n          >\n            Recommendations\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6 overflow-y-auto max-h-96\">\n          {activeTab === 'status' && toolsStatus && (\n            <div className=\"space-y-4\">\n              {Object.entries(toolsStatus.tools).map(([key, tool]) => {\n                const StatusIcon = getStatusIcon(tool.available);\n                return (\n                  <div key={key} className=\"flex items-center justify-between p-4 bg-slate-700 rounded-lg\">\n                    <div className=\"flex items-center space-x-4\">\n                      <StatusIcon className={`w-6 h-6 ${getStatusColor(tool.available)}`} />\n                      <div>\n                        <h3 className=\"text-white font-medium\">{tool.tool}</h3>\n                        <p className=\"text-sm text-slate-400\">\n                          {tool.available ? 'Ready for scanning' : tool.error || 'Not installed'}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center space-x-3\">\n                      {tool.available && (\n                        <span className=\"bg-green-900/50 text-green-300 px-2 py-1 rounded text-xs\">\n                          Installed\n                        </span>\n                      )}\n                      <button\n                        onClick={() => testTool(key)}\n                        disabled={testingTool === key}\n                        className=\"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-800 text-white px-3 py-1 rounded text-sm transition\"\n                      >\n                        {testingTool === key ? 'Testing...' : 'Test'}\n                      </button>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          )}\n\n          {activeTab === 'install' && toolsStatus && (\n            <div className=\"space-y-6\">\n              <div className=\"bg-blue-900/20 border border-blue-500/30 rounded-lg p-4\">\n                <h3 className=\"text-blue-400 font-medium mb-2 flex items-center\">\n                  <CommandLineIcon className=\"w-5 h-5 mr-2\" />\n                  Quick Setup (Linux)\n                </h3>\n                <div className=\"bg-slate-900 rounded p-3 font-mono text-sm text-slate-300\">\n                  <div>sudo apt-get update</div>\n                  <div>sudo apt-get install nmap sqlmap nikto dirb gobuster</div>\n                  <div>gem install wpscan</div>\n                  <div>go install github.com/projectdiscovery/nuclei/v2/cmd/nuclei@latest</div>\n                </div>\n              </div>\n\n              <div className=\"bg-cyan-900/20 border border-cyan-500/30 rounded-lg p-4\">\n                <h3 className=\"text-cyan-400 font-medium mb-2 flex items-center\">\n                  <CommandLineIcon className=\"w-5 h-5 mr-2\" />\n                  Docker Setup (Recommended)\n                </h3>\n                <div className=\"bg-slate-900 rounded p-3 font-mono text-sm text-slate-300\">\n                  <div>docker run -d -p 8080:8080 owasp/zap2docker-stable</div>\n                  <div>docker run -d -p 9000:9000 sonarqube:community</div>\n                  <div>docker pull projectdiscovery/nuclei</div>\n                </div>\n              </div>\n\n              <div className=\"space-y-3\">\n                <h3 className=\"text-white font-medium\">Individual Tool Installation:</h3>\n                {Object.entries(toolsStatus.installInstructions).map(([tool, instruction]) => (\n                  <div key={tool} className=\"bg-slate-700 rounded-lg p-3\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <span className=\"text-white font-medium capitalize\">{tool}</span>\n                      <span className={`px-2 py-1 rounded text-xs ${\n                        toolsStatus.tools[tool]?.available\n                          ? 'bg-green-900/50 text-green-300'\n                          : 'bg-red-900/50 text-red-300'\n                      }`}>\n                        {toolsStatus.tools[tool]?.available ? 'Installed' : 'Missing'}\n                      </span>\n                    </div>\n                    <div className=\"text-sm text-slate-300\">{instruction}</div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {activeTab === 'recommendations' && toolsStatus && (\n            <div className=\"space-y-4\">\n              {toolsStatus.recommendations.map((rec, index) => (\n                <div key={index} className={`p-4 rounded-lg border ${\n                  rec.priority === 'high'\n                    ? 'bg-red-900/20 border-red-500/30'\n                    : 'bg-yellow-900/20 border-yellow-500/30'\n                }`}>\n                  <div className=\"flex items-start space-x-3\">\n                    <ExclamationTriangleIcon className={`w-5 h-5 mt-0.5 ${\n                      rec.priority === 'high' ? 'text-red-400' : 'text-yellow-400'\n                    }`} />\n                    <div className=\"flex-1\">\n                      <h4 className=\"text-white font-medium\">{rec.tool}</h4>\n                      <p className=\"text-slate-300 text-sm mb-2\">{rec.reason}</p>\n                      <div className=\"bg-slate-800 rounded p-2 font-mono text-sm text-slate-300\">\n                        {rec.action}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              ))}\n              \n              {toolsStatus.recommendations.length === 0 && (\n                <div className=\"text-center py-8\">\n                  <CheckCircleIcon className=\"w-16 h-16 text-green-400 mx-auto mb-4\" />\n                  <h3 className=\"text-white font-medium mb-2\">All Set!</h3>\n                  <p className=\"text-slate-400\">All essential security tools are properly configured.</p>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"bg-slate-700 p-4 flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2 text-sm text-slate-400\">\n            <DocumentTextIcon className=\"w-4 h-4\" />\n            <span>See TOOLS_INSTALLATION.md for detailed setup guide</span>\n          </div>\n          <div className=\"flex space-x-3\">\n            <button\n              onClick={checkToolsStatus}\n              className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition flex items-center space-x-2\"\n            >\n              <ArrowPathIcon className=\"w-4 h-4\" />\n              <span>Refresh</span>\n            </button>\n            <button\n              onClick={onClose}\n              className=\"bg-slate-600 hover:bg-slate-500 text-white px-4 py-2 rounded transition\"\n            >\n              Close\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default SecurityToolsStatus;